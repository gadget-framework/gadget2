<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gadget: OptInfoBFGS Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Gadget
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classOptInfoBFGS-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">OptInfoBFGS Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This is the class used for the BFGS optimisation.  
 <a href="classOptInfoBFGS.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="optinfo_8h_source.html">optinfo.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for OptInfoBFGS:</div>
<div class="dyncontent">
<div class="center"><img src="classOptInfoBFGS__inherit__graph.png" border="0" usemap="#aOptInfoBFGS_inherit__map" alt="Inheritance graph"/></div>
<map name="aOptInfoBFGS_inherit__map" id="aOptInfoBFGS_inherit__map">
<area shape="rect" title="This is the class used for the BFGS optimisation." alt="" coords="5,248,177,384"/>
<area shape="rect" href="classOptInfo.html" title="This is the base class used to perform the optimisation calculation for the model." alt="" coords="5,5,177,200"/>
</map>
</div>
<div class="dynheader">
Collaboration diagram for OptInfoBFGS:</div>
<div class="dyncontent">
<div class="center"><img src="classOptInfoBFGS__coll__graph.png" border="0" usemap="#aOptInfoBFGS_coll__map" alt="Collaboration graph"/></div>
<map name="aOptInfoBFGS_coll__map" id="aOptInfoBFGS_coll__map">
<area shape="rect" title="This is the class used for the BFGS optimisation." alt="" coords="5,248,177,384"/>
<area shape="rect" href="classOptInfo.html" title="This is the base class used to perform the optimisation calculation for the model." alt="" coords="5,5,177,200"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0736fea39fc5c88579e6616ea1d71e1d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptInfoBFGS.html#a0736fea39fc5c88579e6616ea1d71e1d">OptInfoBFGS</a> ()</td></tr>
<tr class="memdesc:a0736fea39fc5c88579e6616ea1d71e1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the default <a class="el" href="classOptInfoBFGS.html" title="This is the class used for the BFGS optimisation.">OptInfoBFGS</a> constructor.  <a href="classOptInfoBFGS.html#a0736fea39fc5c88579e6616ea1d71e1d">More...</a><br /></td></tr>
<tr class="separator:a0736fea39fc5c88579e6616ea1d71e1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63c45d622f244b40bd9c8bdb08b00184"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptInfoBFGS.html#a63c45d622f244b40bd9c8bdb08b00184">~OptInfoBFGS</a> ()</td></tr>
<tr class="memdesc:a63c45d622f244b40bd9c8bdb08b00184"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the default <a class="el" href="classOptInfoBFGS.html" title="This is the class used for the BFGS optimisation.">OptInfoBFGS</a> destructor.  <a href="classOptInfoBFGS.html#a63c45d622f244b40bd9c8bdb08b00184">More...</a><br /></td></tr>
<tr class="separator:a63c45d622f244b40bd9c8bdb08b00184"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a800cf43a341d8bfcaea992a81d24473e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptInfoBFGS.html#a800cf43a341d8bfcaea992a81d24473e">read</a> (<a class="el" href="classCommentStream.html">CommentStream</a> &amp;infile, char *text)</td></tr>
<tr class="memdesc:a800cf43a341d8bfcaea992a81d24473e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the function used to read in the BFGS parameters.  <a href="classOptInfoBFGS.html#a800cf43a341d8bfcaea992a81d24473e">More...</a><br /></td></tr>
<tr class="separator:a800cf43a341d8bfcaea992a81d24473e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa557b155aaf45e3f173f69c5a72c7a2b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptInfoBFGS.html#aa557b155aaf45e3f173f69c5a72c7a2b">Print</a> (ofstream &amp;outfile, int prec)</td></tr>
<tr class="memdesc:aa557b155aaf45e3f173f69c5a72c7a2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function will print information from the optimisation algorithm.  <a href="classOptInfoBFGS.html#aa557b155aaf45e3f173f69c5a72c7a2b">More...</a><br /></td></tr>
<tr class="separator:aa557b155aaf45e3f173f69c5a72c7a2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02cc9110e69fc34ae4820640ac8163c1"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptInfoBFGS.html#a02cc9110e69fc34ae4820640ac8163c1">OptimiseLikelihood</a> ()</td></tr>
<tr class="memdesc:a02cc9110e69fc34ae4820640ac8163c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the function that will calculate the likelihood score using the BFGS optimiser.  <a href="classOptInfoBFGS.html#a02cc9110e69fc34ae4820640ac8163c1">More...</a><br /></td></tr>
<tr class="separator:a02cc9110e69fc34ae4820640ac8163c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classOptInfo"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classOptInfo')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classOptInfo.html">OptInfo</a></td></tr>
<tr class="memitem:a2d565412304a43f431c996f2f77d9959 inherit pub_methods_classOptInfo"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptInfo.html#a2d565412304a43f431c996f2f77d9959">OptInfo</a> ()</td></tr>
<tr class="memdesc:a2d565412304a43f431c996f2f77d9959 inherit pub_methods_classOptInfo"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the default <a class="el" href="classOptInfo.html" title="This is the base class used to perform the optimisation calculation for the model.">OptInfo</a> constructor.  <a href="classOptInfo.html#a2d565412304a43f431c996f2f77d9959">More...</a><br /></td></tr>
<tr class="separator:a2d565412304a43f431c996f2f77d9959 inherit pub_methods_classOptInfo"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9745b0e9e967e2def2275a8d8c60e28a inherit pub_methods_classOptInfo"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptInfo.html#a9745b0e9e967e2def2275a8d8c60e28a">~OptInfo</a> ()</td></tr>
<tr class="memdesc:a9745b0e9e967e2def2275a8d8c60e28a inherit pub_methods_classOptInfo"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the default <a class="el" href="classOptInfo.html" title="This is the base class used to perform the optimisation calculation for the model.">OptInfo</a> destructor.  <a href="classOptInfo.html#a9745b0e9e967e2def2275a8d8c60e28a">More...</a><br /></td></tr>
<tr class="separator:a9745b0e9e967e2def2275a8d8c60e28a inherit pub_methods_classOptInfo"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe6f180ea309476b7b665c8df62e28e6 inherit pub_methods_classOptInfo"><td class="memItemLeft" align="right" valign="top"><a class="el" href="optinfo_8h.html#a2809124eff04ad302ca62f63f9408f1e">OptType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptInfo.html#abe6f180ea309476b7b665c8df62e28e6">getType</a> () const</td></tr>
<tr class="memdesc:abe6f180ea309476b7b665c8df62e28e6 inherit pub_methods_classOptInfo"><td class="mdescLeft">&#160;</td><td class="mdescRight">This will return the type of optimisation class.  <a href="classOptInfo.html#abe6f180ea309476b7b665c8df62e28e6">More...</a><br /></td></tr>
<tr class="separator:abe6f180ea309476b7b665c8df62e28e6 inherit pub_methods_classOptInfo"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classOptInfo"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classOptInfo')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classOptInfo.html">OptInfo</a></td></tr>
<tr class="memitem:a169ad12990f89f524f407c1c812c9d40 inherit pro_attribs_classOptInfo"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptInfo.html#a169ad12990f89f524f407c1c812c9d40">converge</a></td></tr>
<tr class="memdesc:a169ad12990f89f524f407c1c812c9d40 inherit pro_attribs_classOptInfo"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the flag used to denote whether the optimisation converged or not.  <a href="classOptInfo.html#a169ad12990f89f524f407c1c812c9d40">More...</a><br /></td></tr>
<tr class="separator:a169ad12990f89f524f407c1c812c9d40 inherit pro_attribs_classOptInfo"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a631a14236309895d080d09d55c6eed98 inherit pro_attribs_classOptInfo"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptInfo.html#a631a14236309895d080d09d55c6eed98">iters</a></td></tr>
<tr class="memdesc:a631a14236309895d080d09d55c6eed98 inherit pro_attribs_classOptInfo"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the number of iterations that took place during the optimisation.  <a href="classOptInfo.html#a631a14236309895d080d09d55c6eed98">More...</a><br /></td></tr>
<tr class="separator:a631a14236309895d080d09d55c6eed98 inherit pro_attribs_classOptInfo"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64f39ba4cd51ecb3dd2d2ac18226c34a inherit pro_attribs_classOptInfo"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptInfo.html#a64f39ba4cd51ecb3dd2d2ac18226c34a">score</a></td></tr>
<tr class="memdesc:a64f39ba4cd51ecb3dd2d2ac18226c34a inherit pro_attribs_classOptInfo"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the value of the best likelihood score from the optimisation.  <a href="classOptInfo.html#a64f39ba4cd51ecb3dd2d2ac18226c34a">More...</a><br /></td></tr>
<tr class="separator:a64f39ba4cd51ecb3dd2d2ac18226c34a inherit pro_attribs_classOptInfo"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad45b0ab7e75f6e2b55c19fc09019857b inherit pro_attribs_classOptInfo"><td class="memItemLeft" align="right" valign="top"><a class="el" href="optinfo_8h.html#a2809124eff04ad302ca62f63f9408f1e">OptType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOptInfo.html#ad45b0ab7e75f6e2b55c19fc09019857b">type</a></td></tr>
<tr class="memdesc:ad45b0ab7e75f6e2b55c19fc09019857b inherit pro_attribs_classOptInfo"><td class="mdescLeft">&#160;</td><td class="mdescRight">This denotes what type of optimisation class has been created.  <a href="classOptInfo.html#ad45b0ab7e75f6e2b55c19fc09019857b">More...</a><br /></td></tr>
<tr class="separator:ad45b0ab7e75f6e2b55c19fc09019857b inherit pro_attribs_classOptInfo"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is the class used for the BFGS optimisation. </p>
<p>BFGS is a quasi-Newton global optimisation method that uses information about the gradient of the function at the current point to calculate the best direction to look in to find a better point. Using this information, the BFGS algorithm can iteratively calculate a better approximation to the inverse Hessian matrix, which will lead to a better approximation of the minimum value. From an initial starting point, the gradient of the function is calculated and then the algorithm uses this information to calculate the best direction to perform a linesearch for a point that is ''sufficiently better''. The linesearch that is used in Gadget to look for a better point in this direction is the ''Armijo'' linesearch. The algorithm will then adjust the current estimate of the inverse Hessian matrix, and restart from this new point. If a better point cannot be found, then the inverse Hessian matrix is reset and the algorithm restarts from the last accepted point.</p>
<p>The BFGS algorithm used in Gadget is derived from that presented by Dimitri P Bertsekas, ''Nonlinear Programming'' (2nd edition, pp22-61) published by Athena Scientific. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a0736fea39fc5c88579e6616ea1d71e1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0736fea39fc5c88579e6616ea1d71e1d">&#9670;&nbsp;</a></span>OptInfoBFGS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OptInfoBFGS::OptInfoBFGS </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the default <a class="el" href="classOptInfoBFGS.html" title="This is the class used for the BFGS optimisation.">OptInfoBFGS</a> constructor. </p>

</div>
</div>
<a id="a63c45d622f244b40bd9c8bdb08b00184"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63c45d622f244b40bd9c8bdb08b00184">&#9670;&nbsp;</a></span>~OptInfoBFGS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual OptInfoBFGS::~OptInfoBFGS </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is the default <a class="el" href="classOptInfoBFGS.html" title="This is the class used for the BFGS optimisation.">OptInfoBFGS</a> destructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a02cc9110e69fc34ae4820640ac8163c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02cc9110e69fc34ae4820640ac8163c1">&#9670;&nbsp;</a></span>OptimiseLikelihood()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void OptInfoBFGS::OptimiseLikelihood </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is the function that will calculate the likelihood score using the BFGS optimiser. </p>

<p>Reimplemented from <a class="el" href="classOptInfo.html#aa1669792d2d4cdac36d29506d509633b">OptInfo</a>.</p>

</div>
</div>
<a id="aa557b155aaf45e3f173f69c5a72c7a2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa557b155aaf45e3f173f69c5a72c7a2b">&#9670;&nbsp;</a></span>Print()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void OptInfoBFGS::Print </td>
          <td>(</td>
          <td class="paramtype">ofstream &amp;&#160;</td>
          <td class="paramname"><em>outfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>prec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function will print information from the optimisation algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">outfile</td><td>is the ofstream that the optimisation information gets sent to </td></tr>
    <tr><td class="paramname">prec</td><td>is the precision to use in the output file </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classOptInfo.html#ac6c7712801dcbb17879686d7face68a1">OptInfo</a>.</p>

</div>
</div>
<a id="a800cf43a341d8bfcaea992a81d24473e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a800cf43a341d8bfcaea992a81d24473e">&#9670;&nbsp;</a></span>read()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void OptInfoBFGS::read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCommentStream.html">CommentStream</a> &amp;&#160;</td>
          <td class="paramname"><em>infile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>text</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is the function used to read in the BFGS parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infile</td><td>is the <a class="el" href="classCommentStream.html" title="This is the class used to strip comments (and whitespace) from any input stream.">CommentStream</a> to read the optimisation parameters from </td></tr>
    <tr><td class="paramname">text</td><td>is a text string used to compare parameter names </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classOptInfo.html#aaf5d5d5f217b0adba0c586d5fb616f2f">OptInfo</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/include/<a class="el" href="optinfo_8h_source.html">optinfo.h</a></li>
<li>src/<a class="el" href="bfgs_8cc.html">bfgs.cc</a></li>
<li>src/<a class="el" href="optinfobfgs_8cc.html">optinfobfgs.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
