<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Optimisation File | Gadget userguide</title>
  <meta name="description" content="11 Optimisation File | Gadget userguide" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Optimisation File | Gadget userguide" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Optimisation File | Gadget userguide" />
  
  
  

<meta name="author" content="MFRI" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chap-param.html"/>
<link rel="next" href="chap-output.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to Gadget</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#sec-whatisgadget"><i class="fa fa-check"></i><b>1.1</b> What is Gadget?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#sec-gettinggadget"><i class="fa fa-check"></i><b>1.2</b> Getting Gadget</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#sec-runninggadget"><i class="fa fa-check"></i><b>1.3</b> Running Gadget</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#sec-starting"><i class="fa fa-check"></i><b>1.4</b> Starting Switches</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap-input.html"><a href="chap-input.html"><i class="fa fa-check"></i><b>2</b> Input Files</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chap-input.html"><a href="chap-input.html#sec-comments"><i class="fa fa-check"></i><b>2.1</b> Comments in Input Files</a></li>
<li class="chapter" data-level="2.2" data-path="chap-input.html"><a href="chap-input.html#sec-whatdoeshash"><i class="fa fa-check"></i><b>2.2</b> What Does The # Mean?</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chap-input.html"><a href="chap-input.html#switches"><i class="fa fa-check"></i><b>2.2.1</b> Switches</a></li>
<li class="chapter" data-level="2.2.2" data-path="chap-input.html"><a href="chap-input.html#functions"><i class="fa fa-check"></i><b>2.2.2</b> Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap-model.html"><a href="chap-model.html"><i class="fa fa-check"></i><b>3</b> Model Files</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chap-model.html"><a href="chap-model.html#sec-mainfile"><i class="fa fa-check"></i><b>3.1</b> Main File</a></li>
<li class="chapter" data-level="3.2" data-path="chap-model.html"><a href="chap-model.html#sec-timefile"><i class="fa fa-check"></i><b>3.2</b> Time File</a></li>
<li class="chapter" data-level="3.3" data-path="chap-model.html"><a href="chap-model.html#sec-areafile"><i class="fa fa-check"></i><b>3.3</b> Area File</a></li>
<li class="chapter" data-level="3.4" data-path="chap-model.html"><a href="chap-model.html#sec-otherinputfile"><i class="fa fa-check"></i><b>3.4</b> Other Input Data Files</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chap-model.html"><a href="chap-model.html#aggregation-files"><i class="fa fa-check"></i><b>3.4.1</b> Aggregation Files</a></li>
<li class="chapter" data-level="3.4.2" data-path="chap-model.html"><a href="chap-model.html#subsec-timevar"><i class="fa fa-check"></i><b>3.4.2</b> TimeVariable Files</a></li>
<li class="chapter" data-level="3.4.3" data-path="chap-model.html"><a href="chap-model.html#subsec-stockvar"><i class="fa fa-check"></i><b>3.4.3</b> StockVariable Files</a></li>
<li class="chapter" data-level="3.4.4" data-path="chap-model.html"><a href="chap-model.html#subsec-aat"><i class="fa fa-check"></i><b>3.4.4</b> ActionAtTime</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap-stock.html"><a href="chap-stock.html"><i class="fa fa-check"></i><b>4</b> Stock Files</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chap-stock.html"><a href="chap-stock.html#sec-stockrefweight"><i class="fa fa-check"></i><b>4.1</b> Reference Weight</a></li>
<li class="chapter" data-level="4.2" data-path="chap-stock.html"><a href="chap-stock.html#sec-stockgrowthlength"><i class="fa fa-check"></i><b>4.2</b> Growth and Eat Lengths</a></li>
<li class="chapter" data-level="4.3" data-path="chap-stock.html"><a href="chap-stock.html#sec-stockgrowth"><i class="fa fa-check"></i><b>4.3</b> Growth</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="chap-stock.html"><a href="chap-stock.html#subsec-growth1"><i class="fa fa-check"></i><b>4.3.1</b> MULTSPEC Growth Function</a></li>
<li class="chapter" data-level="4.3.2" data-path="chap-stock.html"><a href="chap-stock.html#subsec-growth3"><i class="fa fa-check"></i><b>4.3.2</b> WeightVB Growth Function</a></li>
<li class="chapter" data-level="4.3.3" data-path="chap-stock.html"><a href="chap-stock.html#subsec-growth4"><i class="fa fa-check"></i><b>4.3.3</b> WeightJones Growth Function</a></li>
<li class="chapter" data-level="4.3.4" data-path="chap-stock.html"><a href="chap-stock.html#subsec-growth5"><i class="fa fa-check"></i><b>4.3.4</b> WeightVBExpanded Growth Function</a></li>
<li class="chapter" data-level="4.3.5" data-path="chap-stock.html"><a href="chap-stock.html#subsec-growth6"><i class="fa fa-check"></i><b>4.3.5</b> LengthVB Growth Function</a></li>
<li class="chapter" data-level="4.3.6" data-path="chap-stock.html"><a href="chap-stock.html#subsec-growth7"><i class="fa fa-check"></i><b>4.3.6</b> LengthPower Growth Function</a></li>
<li class="chapter" data-level="4.3.7" data-path="chap-stock.html"><a href="chap-stock.html#subsec-growth8"><i class="fa fa-check"></i><b>4.3.7</b> LengthVBSimple Growth Function</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="chap-stock.html"><a href="chap-stock.html#sec-stockgrowthimplement"><i class="fa fa-check"></i><b>4.4</b> Growth Implementation</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="chap-stock.html"><a href="chap-stock.html#beta-binomial"><i class="fa fa-check"></i><b>4.4.1</b> Beta-Binomial</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="chap-stock.html"><a href="chap-stock.html#sec-stocknatmort"><i class="fa fa-check"></i><b>4.5</b> Natural Mortality</a></li>
<li class="chapter" data-level="4.6" data-path="chap-stock.html"><a href="chap-stock.html#sec-stockprey"><i class="fa fa-check"></i><b>4.6</b> Stock Prey</a></li>
<li class="chapter" data-level="4.7" data-path="chap-stock.html"><a href="chap-stock.html#sec-stockpredator"><i class="fa fa-check"></i><b>4.7</b> Stock Predator</a></li>
<li class="chapter" data-level="4.8" data-path="chap-stock.html"><a href="chap-stock.html#sec-consumption"><i class="fa fa-check"></i><b>4.8</b> Consumption</a></li>
<li class="chapter" data-level="4.9" data-path="chap-stock.html"><a href="chap-stock.html#sec-suitability"><i class="fa fa-check"></i><b>4.9</b> Suitability</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="chap-stock.html"><a href="chap-stock.html#constant-suitability-function"><i class="fa fa-check"></i><b>4.9.1</b> Constant Suitability Function</a></li>
<li class="chapter" data-level="4.9.2" data-path="chap-stock.html"><a href="chap-stock.html#straightline-suitability-function"><i class="fa fa-check"></i><b>4.9.2</b> StraightLine Suitability Function</a></li>
<li class="chapter" data-level="4.9.3" data-path="chap-stock.html"><a href="chap-stock.html#exponential-suitability-function"><i class="fa fa-check"></i><b>4.9.3</b> Exponential Suitability Function</a></li>
<li class="chapter" data-level="4.9.4" data-path="chap-stock.html"><a href="chap-stock.html#exponentiall50-suitability-function"><i class="fa fa-check"></i><b>4.9.4</b> ExponentialL50 Suitability Function</a></li>
<li class="chapter" data-level="4.9.5" data-path="chap-stock.html"><a href="chap-stock.html#richards-suitability-function"><i class="fa fa-check"></i><b>4.9.5</b> Richards Suitability Function</a></li>
<li class="chapter" data-level="4.9.6" data-path="chap-stock.html"><a href="chap-stock.html#andersen-suitability-function"><i class="fa fa-check"></i><b>4.9.6</b> Andersen Suitability Function</a></li>
<li class="chapter" data-level="4.9.7" data-path="chap-stock.html"><a href="chap-stock.html#andersen-fleet-suitability-function"><i class="fa fa-check"></i><b>4.9.7</b> Andersen Fleet Suitability Function</a></li>
<li class="chapter" data-level="4.9.8" data-path="chap-stock.html"><a href="chap-stock.html#gamma-suitability-function"><i class="fa fa-check"></i><b>4.9.8</b> Gamma Suitability Function</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="chap-stock.html"><a href="chap-stock.html#sec-stockinitial"><i class="fa fa-check"></i><b>4.10</b> Initial Conditions</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="chap-stock.html"><a href="chap-stock.html#normal-condition-distribution"><i class="fa fa-check"></i><b>4.10.1</b> Normal Condition Distribution</a></li>
<li class="chapter" data-level="4.10.2" data-path="chap-stock.html"><a href="chap-stock.html#normal-parametric-distribution"><i class="fa fa-check"></i><b>4.10.2</b> Normal Parametric Distribution</a></li>
<li class="chapter" data-level="4.10.3" data-path="chap-stock.html"><a href="chap-stock.html#numerical-distribution"><i class="fa fa-check"></i><b>4.10.3</b> Numerical Distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="chap-stock.html"><a href="chap-stock.html#sec-stockmigrate"><i class="fa fa-check"></i><b>4.11</b> Migration</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="chap-stock.html"><a href="chap-stock.html#migration-matrices"><i class="fa fa-check"></i><b>4.11.1</b> Migration Matrices</a></li>
<li class="chapter" data-level="4.11.2" data-path="chap-stock.html"><a href="chap-stock.html#migration-ratios"><i class="fa fa-check"></i><b>4.11.2</b> Migration Ratios</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="chap-stock.html"><a href="chap-stock.html#sec-stockmature"><i class="fa fa-check"></i><b>4.12</b> Maturation</a>
<ul>
<li class="chapter" data-level="4.12.1" data-path="chap-stock.html"><a href="chap-stock.html#constant-maturity-function"><i class="fa fa-check"></i><b>4.12.1</b> Constant Maturity Function</a></li>
<li class="chapter" data-level="4.12.2" data-path="chap-stock.html"><a href="chap-stock.html#constantweight-maturity-function"><i class="fa fa-check"></i><b>4.12.2</b> ConstantWeight Maturity Function</a></li>
<li class="chapter" data-level="4.12.3" data-path="chap-stock.html"><a href="chap-stock.html#fixedlength-maturity-function"><i class="fa fa-check"></i><b>4.12.3</b> FixedLength Maturity Function</a></li>
<li class="chapter" data-level="4.12.4" data-path="chap-stock.html"><a href="chap-stock.html#continuous-maturity-function"><i class="fa fa-check"></i><b>4.12.4</b> Continuous Maturity Function</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="chap-stock.html"><a href="chap-stock.html#sec-stockmove"><i class="fa fa-check"></i><b>4.13</b> Movement (“Transition”)</a></li>
<li class="chapter" data-level="4.14" data-path="chap-stock.html"><a href="chap-stock.html#sec-stockrenew"><i class="fa fa-check"></i><b>4.14</b> Renewal (“Recruitment”)</a>
<ul>
<li class="chapter" data-level="4.14.1" data-path="chap-stock.html"><a href="chap-stock.html#normal-condition-distribution-1"><i class="fa fa-check"></i><b>4.14.1</b> Normal Condition Distribution</a></li>
<li class="chapter" data-level="4.14.2" data-path="chap-stock.html"><a href="chap-stock.html#normal-parametric-distribution-1"><i class="fa fa-check"></i><b>4.14.2</b> Normal Parametric Distribution</a></li>
<li class="chapter" data-level="4.14.3" data-path="chap-stock.html"><a href="chap-stock.html#numerical-distribution-1"><i class="fa fa-check"></i><b>4.14.3</b> Numerical Distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.15" data-path="chap-stock.html"><a href="chap-stock.html#sec-stockspawn"><i class="fa fa-check"></i><b>4.15</b> Spawning</a>
<ul>
<li class="chapter" data-level="4.15.1" data-path="chap-stock.html"><a href="chap-stock.html#fecundity-recruitment-function"><i class="fa fa-check"></i><b>4.15.1</b> Fecundity Recruitment Function</a></li>
<li class="chapter" data-level="4.15.2" data-path="chap-stock.html"><a href="chap-stock.html#simplessb-recruitment-function"><i class="fa fa-check"></i><b>4.15.2</b> SimpleSSB Recruitment Function</a></li>
<li class="chapter" data-level="4.15.3" data-path="chap-stock.html"><a href="chap-stock.html#ricker-recruitment-function"><i class="fa fa-check"></i><b>4.15.3</b> Ricker Recruitment Function</a></li>
<li class="chapter" data-level="4.15.4" data-path="chap-stock.html"><a href="chap-stock.html#bevertonholt-recruitment-function"><i class="fa fa-check"></i><b>4.15.4</b> BevertonHolt Recruitment Function</a></li>
<li class="chapter" data-level="4.15.5" data-path="chap-stock.html"><a href="chap-stock.html#hockey-stick-recruitment-function"><i class="fa fa-check"></i><b>4.15.5</b> Hockey stick Recruitment Function</a></li>
<li class="chapter" data-level="4.15.6" data-path="chap-stock.html"><a href="chap-stock.html#baleen-recruitment-function"><i class="fa fa-check"></i><b>4.15.6</b> Baleen Recruitment Function</a></li>
</ul></li>
<li class="chapter" data-level="4.16" data-path="chap-stock.html"><a href="chap-stock.html#sec-lselection"><i class="fa fa-check"></i><b>4.16</b> Length Selection</a>
<ul>
<li class="chapter" data-level="4.16.1" data-path="chap-stock.html"><a href="chap-stock.html#constant-selection-function"><i class="fa fa-check"></i><b>4.16.1</b> Constant Selection Function</a></li>
<li class="chapter" data-level="4.16.2" data-path="chap-stock.html"><a href="chap-stock.html#straightline-selection-function"><i class="fa fa-check"></i><b>4.16.2</b> StraightLine Selection Function</a></li>
<li class="chapter" data-level="4.16.3" data-path="chap-stock.html"><a href="chap-stock.html#exponential-selection-function"><i class="fa fa-check"></i><b>4.16.3</b> Exponential Selection Function</a></li>
</ul></li>
<li class="chapter" data-level="4.17" data-path="chap-stock.html"><a href="chap-stock.html#sec-stockstray"><i class="fa fa-check"></i><b>4.17</b> Straying</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-tag.html"><a href="chap-tag.html"><i class="fa fa-check"></i><b>5</b> Tag Files</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap-tag.html"><a href="chap-tag.html#sec-tagnumbers"><i class="fa fa-check"></i><b>5.1</b> Tagging Numbers</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap-other.html"><a href="chap-other.html"><i class="fa fa-check"></i><b>6</b> Otherfood Files</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chap-other.html"><a href="chap-other.html#sec-foodamounts"><i class="fa fa-check"></i><b>6.1</b> Food Amounts</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap-fleet.html"><a href="chap-fleet.html"><i class="fa fa-check"></i><b>7</b> Fleet Files</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chap-fleet.html"><a href="chap-fleet.html#sec-totalfleet"><i class="fa fa-check"></i><b>7.1</b> TotalFleet</a></li>
<li class="chapter" data-level="7.2" data-path="chap-fleet.html"><a href="chap-fleet.html#sec-numberfleet"><i class="fa fa-check"></i><b>7.2</b> NumberFleet</a></li>
<li class="chapter" data-level="7.3" data-path="chap-fleet.html"><a href="chap-fleet.html#sec-linearfleet"><i class="fa fa-check"></i><b>7.3</b> LinearFleet</a></li>
<li class="chapter" data-level="7.4" data-path="chap-fleet.html"><a href="chap-fleet.html#sec-effortfleet"><i class="fa fa-check"></i><b>7.4</b> EffortFleet</a></li>
<li class="chapter" data-level="7.5" data-path="chap-fleet.html"><a href="chap-fleet.html#sec-quotafleet"><i class="fa fa-check"></i><b>7.5</b> QuotaFleet</a></li>
<li class="chapter" data-level="7.6" data-path="chap-fleet.html"><a href="chap-fleet.html#sec-fleetsuit"><i class="fa fa-check"></i><b>7.6</b> Fleet Suitability</a></li>
<li class="chapter" data-level="7.7" data-path="chap-fleet.html"><a href="chap-fleet.html#sec-fleetamount"><i class="fa fa-check"></i><b>7.7</b> Fleet Amounts</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap-like.html"><a href="chap-like.html"><i class="fa fa-check"></i><b>8</b> Likelihood Files</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chap-like.html"><a href="chap-like.html#sec-boundlike"><i class="fa fa-check"></i><b>8.1</b> BoundLikelihood (“Penalty”)</a></li>
<li class="chapter" data-level="8.2" data-path="chap-like.html"><a href="chap-like.html#sec-understocking"><i class="fa fa-check"></i><b>8.2</b> Understocking</a></li>
<li class="chapter" data-level="8.3" data-path="chap-like.html"><a href="chap-like.html#sec-catchdist"><i class="fa fa-check"></i><b>8.3</b> CatchDistribution</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="chap-like.html"><a href="chap-like.html#sum-of-squares-function"><i class="fa fa-check"></i><b>8.3.1</b> Sum of Squares Function</a></li>
<li class="chapter" data-level="8.3.2" data-path="chap-like.html"><a href="chap-like.html#stratified-sum-of-squares-function"><i class="fa fa-check"></i><b>8.3.2</b> Stratified Sum of Squares Function</a></li>
<li class="chapter" data-level="8.3.3" data-path="chap-like.html"><a href="chap-like.html#multinomial-function"><i class="fa fa-check"></i><b>8.3.3</b> Multinomial Function</a></li>
<li class="chapter" data-level="8.3.4" data-path="chap-like.html"><a href="chap-like.html#pearson-function"><i class="fa fa-check"></i><b>8.3.4</b> Pearson Function</a></li>
<li class="chapter" data-level="8.3.5" data-path="chap-like.html"><a href="chap-like.html#gamma-function"><i class="fa fa-check"></i><b>8.3.5</b> Gamma Function</a></li>
<li class="chapter" data-level="8.3.6" data-path="chap-like.html"><a href="chap-like.html#log-function"><i class="fa fa-check"></i><b>8.3.6</b> Log Function</a></li>
<li class="chapter" data-level="8.3.7" data-path="chap-like.html"><a href="chap-like.html#multivariate-normal-function"><i class="fa fa-check"></i><b>8.3.7</b> Multivariate Normal Function</a></li>
<li class="chapter" data-level="8.3.8" data-path="chap-like.html"><a href="chap-like.html#multivariate-logistic-function"><i class="fa fa-check"></i><b>8.3.8</b> Multivariate Logistic Function</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="chap-like.html"><a href="chap-like.html#sec-catchstat"><i class="fa fa-check"></i><b>8.4</b> CatchStatistics</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="chap-like.html"><a href="chap-like.html#weighted-sum-of-squares-of-mean-length"><i class="fa fa-check"></i><b>8.4.1</b> Weighted Sum of Squares of Mean Length</a></li>
<li class="chapter" data-level="8.4.2" data-path="chap-like.html"><a href="chap-like.html#weighted-sum-of-squares-of-mean-lengthwith-given-standard-deviation"><i class="fa fa-check"></i><b>8.4.2</b> Weighted Sum of Squares of Mean LengthWith Given Standard Deviation</a></li>
<li class="chapter" data-level="8.4.3" data-path="chap-like.html"><a href="chap-like.html#weighted-sum-of-squares-of-mean-weightwith-given-standard-deviation"><i class="fa fa-check"></i><b>8.4.3</b> Weighted Sum of Squares of Mean WeightWith Given Standard Deviation</a></li>
<li class="chapter" data-level="8.4.4" data-path="chap-like.html"><a href="chap-like.html#unweighted-sum-of-squares-of-mean-weight"><i class="fa fa-check"></i><b>8.4.4</b> Unweighted Sum of Squares of Mean Weight</a></li>
<li class="chapter" data-level="8.4.5" data-path="chap-like.html"><a href="chap-like.html#unweighted-sum-of-squares-of-mean-length"><i class="fa fa-check"></i><b>8.4.5</b> Unweighted Sum of Squares of Mean Length</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="chap-like.html"><a href="chap-like.html#sec-stockdist"><i class="fa fa-check"></i><b>8.5</b> StockDistribution</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="chap-like.html"><a href="chap-like.html#sum-of-squares-function-1"><i class="fa fa-check"></i><b>8.5.1</b> Sum of Squares Function</a></li>
<li class="chapter" data-level="8.5.2" data-path="chap-like.html"><a href="chap-like.html#multinomial-function-1"><i class="fa fa-check"></i><b>8.5.2</b> Multinomial Function</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="chap-like.html"><a href="chap-like.html#sec-surveyindices"><i class="fa fa-check"></i><b>8.6</b> SurveyIndices</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="chap-like.html"><a href="chap-like.html#subsec-sibylength"><i class="fa fa-check"></i><b>8.6.1</b> SurveyIndices by Length</a></li>
<li class="chapter" data-level="8.6.2" data-path="chap-like.html"><a href="chap-like.html#subsec-sibyage"><i class="fa fa-check"></i><b>8.6.2</b> SurveyIndices by Age</a></li>
<li class="chapter" data-level="8.6.3" data-path="chap-like.html"><a href="chap-like.html#subsec-sibyfleet"><i class="fa fa-check"></i><b>8.6.3</b> SurveyIndices by Fleet</a></li>
<li class="chapter" data-level="8.6.4" data-path="chap-like.html"><a href="chap-like.html#subsec-sibyacoustic"><i class="fa fa-check"></i><b>8.6.4</b> SurveyIndices by Acoustic</a></li>
<li class="chapter" data-level="8.6.5" data-path="chap-like.html"><a href="chap-like.html#subsec-sibyeffort"><i class="fa fa-check"></i><b>8.6.5</b> SurveyIndices by Effort</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="chap-like.html"><a href="chap-like.html#sec-surveydistribution"><i class="fa fa-check"></i><b>8.7</b> SurveyDistribution</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="chap-like.html"><a href="chap-like.html#linear-fit"><i class="fa fa-check"></i><b>8.7.1</b> Linear Fit</a></li>
<li class="chapter" data-level="8.7.2" data-path="chap-like.html"><a href="chap-like.html#power-fit"><i class="fa fa-check"></i><b>8.7.2</b> Power Fit</a></li>
<li class="chapter" data-level="8.7.3" data-path="chap-like.html"><a href="chap-like.html#multinomial-function-2"><i class="fa fa-check"></i><b>8.7.3</b> Multinomial Function</a></li>
<li class="chapter" data-level="8.7.4" data-path="chap-like.html"><a href="chap-like.html#pearson-function-1"><i class="fa fa-check"></i><b>8.7.4</b> Pearson Function</a></li>
<li class="chapter" data-level="8.7.5" data-path="chap-like.html"><a href="chap-like.html#gamma-function-1"><i class="fa fa-check"></i><b>8.7.5</b> Gamma Function</a></li>
<li class="chapter" data-level="8.7.6" data-path="chap-like.html"><a href="chap-like.html#log-function-1"><i class="fa fa-check"></i><b>8.7.6</b> Log Function</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="chap-like.html"><a href="chap-like.html#sec-stomach"><i class="fa fa-check"></i><b>8.8</b> StomachContent</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="chap-like.html"><a href="chap-like.html#scsimple-function"><i class="fa fa-check"></i><b>8.8.1</b> SCSimple Function</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="chap-like.html"><a href="chap-like.html#sec-recaptures"><i class="fa fa-check"></i><b>8.9</b> Recaptures</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="chap-like.html"><a href="chap-like.html#poisson-function"><i class="fa fa-check"></i><b>8.9.1</b> Poisson Function</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="chap-like.html"><a href="chap-like.html#sec-recstat"><i class="fa fa-check"></i><b>8.10</b> RecStatistics</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="chap-like.html"><a href="chap-like.html#weighted-sum-of-squares-of-mean-length-1"><i class="fa fa-check"></i><b>8.10.1</b> Weighted Sum of Squares of Mean Length</a></li>
<li class="chapter" data-level="8.10.2" data-path="chap-like.html"><a href="chap-like.html#weighted-sum-of-squares-of-mean-lengthwith-given-standard-deviation-1"><i class="fa fa-check"></i><b>8.10.2</b> Weighted Sum of Squares of Mean LengthWith Given Standard Deviation</a></li>
<li class="chapter" data-level="8.10.3" data-path="chap-like.html"><a href="chap-like.html#unweighted-sum-of-squares-of-mean-length-1"><i class="fa fa-check"></i><b>8.10.3</b> Unweighted Sum of Squares of Mean Length</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="chap-like.html"><a href="chap-like.html#sec-migpenalty"><i class="fa fa-check"></i><b>8.11</b> MigrationPenalty</a></li>
<li class="chapter" data-level="8.12" data-path="chap-like.html"><a href="chap-like.html#sec-migpro"><i class="fa fa-check"></i><b>8.12</b> MigrationProportion</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="chap-like.html"><a href="chap-like.html#sum-of-squares-function-2"><i class="fa fa-check"></i><b>8.12.1</b> Sum of Squares Function</a></li>
</ul></li>
<li class="chapter" data-level="8.13" data-path="chap-like.html"><a href="chap-like.html#sec-catchinkilos"><i class="fa fa-check"></i><b>8.13</b> CatchInKilos</a>
<ul>
<li class="chapter" data-level="8.13.1" data-path="chap-like.html"><a href="chap-like.html#sum-of-squares-function-3"><i class="fa fa-check"></i><b>8.13.1</b> Sum of Squares Function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap-print.html"><a href="chap-print.html"><i class="fa fa-check"></i><b>9</b> Print Files</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chap-print.html"><a href="chap-print.html#sec-stockstdprinter"><i class="fa fa-check"></i><b>9.1</b> StockStdPrinter</a></li>
<li class="chapter" data-level="9.2" data-path="chap-print.html"><a href="chap-print.html#sec-stockfullprinter"><i class="fa fa-check"></i><b>9.2</b> StockFullPrinter</a></li>
<li class="chapter" data-level="9.3" data-path="chap-print.html"><a href="chap-print.html#sec-stockprinter"><i class="fa fa-check"></i><b>9.3</b> StockPrinter</a></li>
<li class="chapter" data-level="9.4" data-path="chap-print.html"><a href="chap-print.html#sec-predatorprinter"><i class="fa fa-check"></i><b>9.4</b> PredatorPrinter</a></li>
<li class="chapter" data-level="9.5" data-path="chap-print.html"><a href="chap-print.html#sec-predatoroverprinter"><i class="fa fa-check"></i><b>9.5</b> PredatorOverPrinter</a></li>
<li class="chapter" data-level="9.6" data-path="chap-print.html"><a href="chap-print.html#sec-preyoverprinter"><i class="fa fa-check"></i><b>9.6</b> PreyOverPrinter</a></li>
<li class="chapter" data-level="9.7" data-path="chap-print.html"><a href="chap-print.html#sec-stockpreyfullprinter"><i class="fa fa-check"></i><b>9.7</b> StockPreyFullPrinter</a></li>
<li class="chapter" data-level="9.8" data-path="chap-print.html"><a href="chap-print.html#sec-stockpreyprinter"><i class="fa fa-check"></i><b>9.8</b> StockPreyPrinter</a></li>
<li class="chapter" data-level="9.9" data-path="chap-print.html"><a href="chap-print.html#sec-predatorpreyprinter"><i class="fa fa-check"></i><b>9.9</b> PredatorPreyPrinter</a></li>
<li class="chapter" data-level="9.10" data-path="chap-print.html"><a href="chap-print.html#sec-likelihoodprinter"><i class="fa fa-check"></i><b>9.10</b> LikelihoodPrinter</a></li>
<li class="chapter" data-level="9.11" data-path="chap-print.html"><a href="chap-print.html#sec-likelihoodsummaryprinter"><i class="fa fa-check"></i><b>9.11</b> LikelihoodSummaryPrinter</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap-param.html"><a href="chap-param.html"><i class="fa fa-check"></i><b>10</b> Parameter File</a></li>
<li class="chapter" data-level="11" data-path="chap-optim.html"><a href="chap-optim.html"><i class="fa fa-check"></i><b>11</b> Optimisation File</a>
<ul>
<li class="chapter" data-level="11.1" data-path="chap-optim.html"><a href="chap-optim.html#sec-hooke"><i class="fa fa-check"></i><b>11.1</b> Hooke &amp; Jeeves</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="chap-optim.html"><a href="chap-optim.html#subsec-hookeover"><i class="fa fa-check"></i><b>11.1.1</b> Overview</a></li>
<li class="chapter" data-level="11.1.2" data-path="chap-optim.html"><a href="chap-optim.html#subsec-hookefile"><i class="fa fa-check"></i><b>11.1.2</b> File Format</a></li>
<li class="chapter" data-level="11.1.3" data-path="chap-optim.html"><a href="chap-optim.html#subsec-hookepar"><i class="fa fa-check"></i><b>11.1.3</b> Parameters</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="chap-optim.html"><a href="chap-optim.html#sec-simann"><i class="fa fa-check"></i><b>11.2</b> Simulated Annealing</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="chap-optim.html"><a href="chap-optim.html#subsec-simannover"><i class="fa fa-check"></i><b>11.2.1</b> Overview</a></li>
<li class="chapter" data-level="11.2.2" data-path="chap-optim.html"><a href="chap-optim.html#subsec-simannfile"><i class="fa fa-check"></i><b>11.2.2</b> File Format</a></li>
<li class="chapter" data-level="11.2.3" data-path="chap-optim.html"><a href="chap-optim.html#subsec-simannpar"><i class="fa fa-check"></i><b>11.2.3</b> Parameters</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="chap-optim.html"><a href="chap-optim.html#sec-bfgs"><i class="fa fa-check"></i><b>11.3</b> BFGS</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="chap-optim.html"><a href="chap-optim.html#subsec-bfgsover"><i class="fa fa-check"></i><b>11.3.1</b> Overview</a></li>
<li class="chapter" data-level="11.3.2" data-path="chap-optim.html"><a href="chap-optim.html#subsec-bfgsfile"><i class="fa fa-check"></i><b>11.3.2</b> File Format</a></li>
<li class="chapter" data-level="11.3.3" data-path="chap-optim.html"><a href="chap-optim.html#subsec-bfgspar"><i class="fa fa-check"></i><b>11.3.3</b> Parameters</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="chap-optim.html"><a href="chap-optim.html#sec-combine"><i class="fa fa-check"></i><b>11.4</b> Combining Optimisation Algorithms</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="chap-optim.html"><a href="chap-optim.html#subsec-combineover"><i class="fa fa-check"></i><b>11.4.1</b> Overview</a></li>
<li class="chapter" data-level="11.4.2" data-path="chap-optim.html"><a href="chap-optim.html#subsec-combinefile"><i class="fa fa-check"></i><b>11.4.2</b> File Format</a></li>
<li class="chapter" data-level="11.4.3" data-path="chap-optim.html"><a href="chap-optim.html#subsec-combinepar"><i class="fa fa-check"></i><b>11.4.3</b> Parameters</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="chap-optim.html"><a href="chap-optim.html#sec-repeat"><i class="fa fa-check"></i><b>11.5</b> Repeatability</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chap-output.html"><a href="chap-output.html"><i class="fa fa-check"></i><b>12</b> Output Files</a>
<ul>
<li class="chapter" data-level="12.1" data-path="chap-output.html"><a href="chap-output.html#sec-paramoutput"><i class="fa fa-check"></i><b>12.1</b> Parameter Output</a></li>
<li class="chapter" data-level="12.2" data-path="chap-output.html"><a href="chap-output.html#sec-likelihoodoutput"><i class="fa fa-check"></i><b>12.2</b> Likelihood Output</a></li>
<li class="chapter" data-level="12.3" data-path="chap-output.html"><a href="chap-output.html#sec-logoutput"><i class="fa fa-check"></i><b>12.3</b> Log Output</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chap-paramin.html"><a href="chap-paramin.html"><i class="fa fa-check"></i><b>13</b> Paramin</a>
<ul>
<li class="chapter" data-level="13.1" data-path="chap-paramin.html"><a href="chap-paramin.html#sec-paramininstall"><i class="fa fa-check"></i><b>13.1</b> Installation</a></li>
<li class="chapter" data-level="13.2" data-path="chap-paramin.html"><a href="chap-paramin.html#sec-runparamin"><i class="fa fa-check"></i><b>13.2</b> Running paramin</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="chap-paramin.html"><a href="chap-paramin.html#additional-information"><i class="fa fa-check"></i><b>13.2.1</b> Additional information</a></li>
<li class="chapter" data-level="13.2.2" data-path="chap-paramin.html"><a href="chap-paramin.html#running-paramin-on-multiple-hostscluster"><i class="fa fa-check"></i><b>13.2.2</b> Running paramin on multiple hosts/cluster</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="chap-reference.html"><a href="chap-reference.html"><i class="fa fa-check"></i><b>14</b> References</a></li>
<li class="chapter" data-level="15" data-path="chap-order.html"><a href="chap-order.html"><i class="fa fa-check"></i><b>15</b> Order of Calculations</a></li>
<li class="chapter" data-level="16" data-path="chap-change.html"><a href="chap-change.html"><i class="fa fa-check"></i><b>16</b> Recent Changes</a>
<ul>
<li class="chapter" data-level="16.1" data-path="chap-change.html"><a href="chap-change.html#sec-v2101"><i class="fa fa-check"></i><b>16.1</b> Gadget version 2.1.01</a></li>
<li class="chapter" data-level="16.2" data-path="chap-change.html"><a href="chap-change.html#sec-v2102"><i class="fa fa-check"></i><b>16.2</b> Gadget version 2.1.02</a></li>
<li class="chapter" data-level="16.3" data-path="chap-change.html"><a href="chap-change.html#sec-v2103"><i class="fa fa-check"></i><b>16.3</b> Gadget version 2.1.03</a></li>
<li class="chapter" data-level="16.4" data-path="chap-change.html"><a href="chap-change.html#sec-v2104"><i class="fa fa-check"></i><b>16.4</b> Gadget version 2.1.04</a></li>
<li class="chapter" data-level="16.5" data-path="chap-change.html"><a href="chap-change.html#sec-v2105"><i class="fa fa-check"></i><b>16.5</b> Gadget version 2.1.05</a></li>
<li class="chapter" data-level="16.6" data-path="chap-change.html"><a href="chap-change.html#sec-v2106"><i class="fa fa-check"></i><b>16.6</b> Gadget version 2.1.06</a></li>
<li class="chapter" data-level="16.7" data-path="chap-change.html"><a href="chap-change.html#sec-v2200"><i class="fa fa-check"></i><b>16.7</b> Gadget version 2.2.00</a></li>
<li class="chapter" data-level="16.8" data-path="chap-change.html"><a href="chap-change.html#sec-v230"><i class="fa fa-check"></i><b>16.8</b> Gadget version 2.3.0</a></li>
<li class="chapter" data-level="16.9" data-path="chap-change.html"><a href="chap-change.html#sec-v231"><i class="fa fa-check"></i><b>16.9</b> Gadget version 2.3.1</a></li>
<li class="chapter" data-level="16.10" data-path="chap-change.html"><a href="chap-change.html#sec-v232"><i class="fa fa-check"></i><b>16.10</b> Gadget version 2.3.2</a></li>
<li class="chapter" data-level="16.11" data-path="chap-change.html"><a href="chap-change.html#sec-v233"><i class="fa fa-check"></i><b>16.11</b> Gadget version 2.3.3</a></li>
<li class="chapter" data-level="16.12" data-path="chap-change.html"><a href="chap-change.html#sec-v234"><i class="fa fa-check"></i><b>16.12</b> Gadget version 2.3.4</a></li>
<li class="chapter" data-level="16.13" data-path="chap-change.html"><a href="chap-change.html#sec-v235"><i class="fa fa-check"></i><b>16.13</b> Gadget version 2.3.5</a></li>
<li class="chapter" data-level="16.14" data-path="chap-change.html"><a href="chap-change.html#sec-v9999"><i class="fa fa-check"></i><b>16.14</b> Gadget development version</a></li>
<li class="chapter" data-level="16.15" data-path="chap-change.html"><a href="chap-change.html#sec:v238"><i class="fa fa-check"></i><b>16.15</b> Gadget version 2.3.8</a></li>
<li class="chapter" data-level="16.16" data-path="chap-change.html"><a href="chap-change.html#sec:v238"><i class="fa fa-check"></i><b>16.16</b> Gadget version 2.3.8</a></li>
<li class="chapter" data-level="16.17" data-path="chap-change.html"><a href="chap-change.html#sec:v239"><i class="fa fa-check"></i><b>16.17</b> Gadget version 2.3.9</a></li>
<li class="chapter" data-level="16.18" data-path="chap-change.html"><a href="chap-change.html#sec:v238"><i class="fa fa-check"></i><b>16.18</b> Gadget version 2.3.8</a></li>
<li class="chapter" data-level="16.19" data-path="chap-change.html"><a href="chap-change.html#sec:v239"><i class="fa fa-check"></i><b>16.19</b> Gadget version 2.3.9</a></li>
<li class="chapter" data-level="16.20" data-path="chap-change.html"><a href="chap-change.html#sec:v2310"><i class="fa fa-check"></i><b>16.20</b> Gadget version 2.3.10</a></li>
<li class="chapter" data-level="16.21" data-path="chap-change.html"><a href="chap-change.html#sec:v9999"><i class="fa fa-check"></i><b>16.21</b> Gadget development version</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Gadget userguide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap-optim" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">11</span> Optimisation File<a href="chap-optim.html#chap-optim" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The optimisation file is used to specify the type of optimisation to be
used, along with any parameters that are needed for the optimisation
algorithm. This file is specified by a “-opt <span class="math inline">\(&lt;\)</span>filename<span class="math inline">\(&gt;\)</span>” command
line option when Gadget is started, for example, this would take the
optimisation information from a file called “optinfo.txt”:</p>
<pre><code>gadget -l -opt optinfo.txt</code></pre>
<p>There are three types of optimisation algorithms currently implemented
in Gadget - these are one based on the Hooke &amp; Jeeves algorithm, one
based on the Simulated Annealing algorithm and one based on the
Broyden-Fletcher-Goldfarb-Shanno (“BFGS”) algorithm. These algorithms
are described in more detail in the following sections. Gadget can also
combine two or more of these algorithms into a single hybrid algorithm,
that should result in a more efficient search for an optimum solution.</p>
<p>All the optimisation techniques used by Gadget attempt to minimise the
likelihood function. That is, they look for the best set of parameters
to run the model with, in order to get the best fit according to the
likelihood functions you have specified. Thus, the optimiser is
attempting to minimize a single one-dimensional measure of fit between
the model output and the data, which can lead to unexpected results.</p>
<p>The optimisation process will tend to produce realistic values for the
most significant parameters (typically growth, recruitment in large year
classes and fishing selectivity) before finding realistic values for
less significant parameters. It should be noted that the parameters
governing recruitment and growth in the last few years with data in a
simulation will be among the last to settle on realistic values. It is
important to ensure that an optimum solution has been reached before
accepting the model, especially if the model is to be used to predict
the population into the future or to examine the strength of the last
few year classes.</p>
<div id="sec-hooke" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Hooke &amp; Jeeves<a href="chap-optim.html#sec-hooke" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="subsec-hookeover" class="section level3 hasAnchor" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> Overview<a href="chap-optim.html#subsec-hookeover" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hooke &amp; Jeeves is a simple and fast optimising method, but somewhat
unreliable, and it is often described as a ‘hill climbing’ technique.
From the initial starting point the algorithm takes a step in various
‘directions’, and conducts a new model run. If the new likelihood score
is better than the old one then the algorithm uses the new point as it’s
best guess. If it is worse then the algorithm retains the old point. The
search proceeds in series of these steps, each step slightly smaller
than the previous one. When the algorithm finds a point which it cannot
improve on with a small step in any direction then it accepts this point
as being the ‘solution’, and exits. It can be seen that this renders the
scheme vulnerable to producing local solutions, accepting a local dip as
being the solution even if a better solution exists elsewhere, beyond a
local ‘hill’ that the algorithm cannot see past. In order to combat this
tendency it is strongly recommended that you re-run the optimisation,
using the final point of one run as the start of the next. This will
effectively re-set the searching step size to large steps, and give
Gadget a chance of escaping from local solutions. Finding the same
result twice in a row does not guarantee it is the best possible
solution, but finding different results certainly indicates that the
larger result is not the solution you are seeking.</p>
<p>The Hooke &amp; Jeeves algorithm used in Gadget is derived from that
originally presented by R. Hooke and T. A. Jeeves, “Direct Search
Solution of Numerical and Statistical Problems” in the April 1961 (Vol.
8, pp. 212-229) issue of the Journal of the ACM, with improvements
presented by Arthur F Kaupe Jr., “Algorithm 178: Direct Search” in the
June 1963 (Vol 6, pp.313-314) issue of the Communications of the ACM.</p>
<p>Hooke &amp; Jeeves is the default optimisation method used for Gadget, and
will be used if no optimisation information file is specified.</p>
</div>
<div id="subsec-hookefile" class="section level3 hasAnchor" number="11.1.2">
<h3><span class="header-section-number">11.1.2</span> File Format<a href="chap-optim.html#subsec-hookefile" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To specify the Hooke &amp; Jeeves algorithm, the optimisation file should
start with the keyword “[hooke]”, followed by (up to) 4 lines giving
the parameters for the optimisation algorithm. Any parameters that are
not specified in the file are given default values, which work
reasonably well for simple Gadget models. The format for this file, and
the default values for the optimisation parameters, are shown below:</p>
<pre><code>[hooke]
hookeiter  1000  ; number of hooke &amp; jeeves iterations
hookeeps   1e-04 ; minimum epsilon, hooke &amp; jeeves halt criteria
rho        0.5   ; step length adjustment factor
lambda     0     ; initial value for the step length</code></pre>
</div>
<div id="subsec-hookepar" class="section level3 hasAnchor" number="11.1.3">
<h3><span class="header-section-number">11.1.3</span> Parameters<a href="chap-optim.html#subsec-hookepar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="hookeiter" class="section level4 hasAnchor" number="11.1.3.1">
<h4><span class="header-section-number">11.1.3.1</span> hookeiter<a href="chap-optim.html#hookeiter" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the maximum number of Gadget model runs that the Hooke &amp; Jeeves
algorithm will use to try to find the best solution. If this number is
exceeded, Gadget will select the best point found so far, and accept
this as the ‘solution’, even though it has not met the convergence
criteria. A warning that Gadget has stopped without finding a solution
that meets the convergence criteria will be printed.</p>
</div>
<div id="hookeeps" class="section level4 hasAnchor" number="11.1.3.2">
<h4><span class="header-section-number">11.1.3.2</span> hookeeps<a href="chap-optim.html#hookeeps" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the criteria for halting the Hooke &amp; Jeeves algorithm at a
minimum, and accepting the current point as the ‘solution’. The
algorithm has “converged” when the size of each step in the search has
been reduced to less than this value, and no further improvements can be
made. This means that each parameter in the Gadget model is less than
hookeeps from their value at the (local) optimum. Larger values of
hookeeps give a quicker running time, but a less accurate estimate of
the minimum. Conversely, smaller values will give a longer running time,
but a more accurate estimate of the minimum.</p>
</div>
<div id="rho" class="section level4 hasAnchor" number="11.1.3.3">
<h4><span class="header-section-number">11.1.3.3</span> rho<a href="chap-optim.html#rho" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the resizing multiplier for the step length of the search made
by the algorithm. The Hooke &amp; Jeeves algorithm works by taking “steps”
from one estimate of a optimum, to another (hopefully better) estimate
of the optimum. Taking big steps gets to the minimum more quickly, at
the risk of ‘stepping over’ an excellent point. When no improvements to
the minimum can be made by taking steps of the current length, the step
length is reduced by multiplying it by rho.</p>
<p>Small values of rho correspond to big step length changes, which make
the algorithm run more quickly. However, there is a chance that these
big changes will accidentally overlook a promising point, leading to
non-convergence. Larger values of rho correspond to smaller step length
changes, which force the algorithm to carefully examine nearby points
instead of optimistically forging ahead, which improves the probability
of convergence. The value of rho must be between 0 and 1.</p>
</div>
<div id="lambda" class="section level4 hasAnchor" number="11.1.3.4">
<h4><span class="header-section-number">11.1.3.4</span> lambda<a href="chap-optim.html#lambda" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the initial value for the size of the steps in the search, which
will be used for the the first search, before any modification to the
step length. All the parameters in the Gadget model are initially scaled
so that their value is 1, and the initial search will then look at the
points <span class="math inline">\(1 \pm \lambda\)</span> for the next optimum. Setting lambda to zero will
set the initial value for the step length equal to rho. The value of
lambda must be between 0 and 1.</p>
</div>
</div>
</div>
<div id="sec-simann" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Simulated Annealing<a href="chap-optim.html#sec-simann" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="subsec-simannover" class="section level3 hasAnchor" number="11.2.1">
<h3><span class="header-section-number">11.2.1</span> Overview<a href="chap-optim.html#subsec-simannover" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Simulated Annealing is a global optimisation method that distinguishes
between different local minimum. From the initial starting point the
algorithm takes a random step in various directions, and conducts a new
model run. If the new likelihood score is better than the old one then
the algorithm uses the new point as it’s best guess. If it is worse then
the algorithm may accept this point, based on the probabilistic
“Metropolis Criteria”, and thus the algorithm can escape from a local
minimum. The search proceeds in series of these steps, with the point
that gives the overall lowest likelihood score is stored as a “best
point”. The algorithm exits when a stable point is found which cannot be
improved on with a small step in any direction, and the Metropolis
Criteria rejects all the steps away from the current best point. The
best point is then accepted as being the ‘solution’.</p>
<p>The Metropolis Criteria will accept a move in an uphill direction (ie. a
point with a worse likelihood score) based on a function of both the
size of the move and a parameter termed “temperature”, and is given in
equation <a href="chap-optim.html#eq:metropolis">(11.1)</a> below:</p>
<p><span class="math display" id="eq:metropolis">\[\begin{equation}
\begin{aligned}
\tag{11.1}
M &amp; = &amp; e^{\displaystyle \frac{-\Delta F} {t}} \nonumber \\
P &amp; = &amp;
\begin{cases}
1 &amp; \textrm{if $M$ &gt; $r$} \\
0 &amp; \textrm{otherwise}
\end{cases}\end{aligned}\end{equation}\]</span></p>
<p>where: <span class="math inline">\(&lt;\Delta F&gt;\)</span> is the change in likelihood score <span class="math inline">\(&lt;\)</span> t <span class="math inline">\(&gt;\)</span> is the
“temperature” of the algorithm <span class="math inline">\(&lt;\)</span> r <span class="math inline">\(&gt;\)</span> is a random number between 0
and 1</p>
<p>Note that when the “temperature” is very high (t <span class="math inline">\(\rightarrow \infty\)</span>),
the Metropolis Criteria will always accept any ‘uphill’ move, and the
Simulated Annealing algorithm will simplify to a form of a random search
algorithm. Conversely, when the temperature is very low (t <span class="math inline">\(\rightarrow\)</span>
0), the Metropolis Criteria will always reject any ‘uphill’ move, and
the Simulated Annealing algorithm will simplify to a form of a
hill-climbing algorithm, similar to Hooke &amp; Jeeves. By slowly reducing
the temperature of the algorithm, the number of uphill moves that are
accepted are reduced and the algorithm will find a minimum.</p>
<p>The terminology for the Simulated Annealing algorithm comes from a
metaphor with the thermodynamic process of cooling molten metals. At
very high temperatures, the atoms in molten metals move very fast, and
slow considerably at lower temperatures. If the metal is cooled slowly
(termed “annealing”), the atoms have time to line up to form a highly
ordered, strong, crystalline structure. If the metal is cooled too
quickly (“quenching”) the resulting solid will have a weaker, less
ordered, structure.</p>
<p>In comparison to the Hooke &amp; Jeeves optimisation algorithm, where Hooke
&amp; Jeeves performs a ‘local’ stepwise search, Simulated Annealing
searches much more widely over the surface in order to find the best
point. By doing this it is less likely than Hooke &amp; Jeeves to be fooled
by a local minimum, and more likely to home in on the true optimum.
However the price to paid for doing this is that it can take
considerably more computer time to reach a solution.</p>
<p>The Simulated Annealing algorithm used in Gadget is derived from that
presented by Corana et al, “Minimising Multimodal Functions of
Continuous Variables with the ‘Simulated Annealing’ Algorithm” in the
September 1987 (Vol. 13, pp. 262-280) issue of the ACM Transactions on
Mathematical Software and Goffe et al, “Global Optimisation of
Statistical Functions with Simulated Annealing” in the January/February
1994 (Vol. 60, pp. 65-100) issue of the Journal of Econometrics.</p>
</div>
<div id="subsec-simannfile" class="section level3 hasAnchor" number="11.2.2">
<h3><span class="header-section-number">11.2.2</span> File Format<a href="chap-optim.html#subsec-simannfile" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To specify the Simulated Annealing algorithm, the optimisation file
should start with the keyword “[simann]”, followed by (up to) 11 lines
giving the parameters for the optimisation algorithm. Any parameters
that are not specified in the file are given default values, which work
reasonably well for simple Gadget models. The format for this file, and
the default values for the optimisation parameters, are shown below:</p>
<pre><code>[simann]
simanniter 2000  ; number of simulated annealing iterations
simanneps  1e-04 ; minimum epsilon, simann halt criteria
t          100   ; simulated annealing initial temperature
rt         0.85  ; temperature reduction factor
nt         2     ; number of loops before temperature adjusted
ns         5     ; number of loops before step length adjusted
vm         1     ; initial value for the maximum step length
cstep      2     ; step length adjustment factor
lratio     0.3   ; lower limit for ratio when adjusting step length
uratio     0.7   ; upper limit for ratio when adjusting step length
check      4     ; number of temperature loops to check</code></pre>
</div>
<div id="subsec-simannpar" class="section level3 hasAnchor" number="11.2.3">
<h3><span class="header-section-number">11.2.3</span> Parameters<a href="chap-optim.html#subsec-simannpar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="simanniter" class="section level4 hasAnchor" number="11.2.3.1">
<h4><span class="header-section-number">11.2.3.1</span> simanniter<a href="chap-optim.html#simanniter" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the maximum number of Gadget model runs that the Simulated
Annealing algorithm will use to try to find the best solution. If this
number is exceeded, Gadget will select the best point found so far, and
accept this as the ‘solution’, even though it has not met the
convergence criteria. A warning that Gadget has stopped without finding
a solution that meets the convergence criteria will be printed.</p>
</div>
<div id="simanneps" class="section level4 hasAnchor" number="11.2.3.2">
<h4><span class="header-section-number">11.2.3.2</span> simanneps<a href="chap-optim.html#simanneps" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the criteria for halting the Simulated Annealing algorithm at a
minimum, and accepting the current point as the ‘solution’. The
algorithm has “converged” if the point found at the end of a temperature
loop is within simanneps of the best point, and is also within simanneps
of the point found at the end of the last ‘check’ temperature loops.
This will mean that during each of the last ‘check’ temperature loops,
the accepted point has moved less than simanneps away from the overall
best point, showing that the best point found so far is stable. Lower
values for simanneps will give a more stable estimate of the minimum, at
the cost of a longer running time. Note that the convergence criteria is
only checked at the end of each temperature loop.</p>
</div>
<div id="t" class="section level4 hasAnchor" number="11.2.3.3">
<h4><span class="header-section-number">11.2.3.3</span> t<a href="chap-optim.html#t" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the initial value for the “temperature” of the Simulated
Annealing algorithm, used to control the speed of the convergence of the
algorithm, using the Metropolis Criteria given in
equation <a href="chap-optim.html#eq:metropolis">(11.1)</a> above. High values for the temperature (t
<span class="math inline">\(\gg \Delta F\)</span>) will mean that most of the uphill moves are accepted,
and the algorithm will be performing a random search, which is
computationally very intensive. Low values for the temperature (t
<span class="math inline">\(\ll \Delta F\)</span>) will mean that most of the uphill moves are rejected and
the algorithm will be performing an inefficient local search.</p>
</div>
<div id="rt" class="section level4 hasAnchor" number="11.2.3.4">
<h4><span class="header-section-number">11.2.3.4</span> rt<a href="chap-optim.html#rt" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the temperature reduction factor, used to lower the temperature
of the algorithm as it moves closer to the minimum. Higher values here
will mean that the temperature is reduced slowly, which will mean that
the algorithm is will examine the search area more thoroughly, leading
to better convergence at a cost of much higher computational time. Lower
values of rt will mean that the temperature is reduced quickly, leading
to faster convergence, possibly to a local minimum that the algorithm
cannot escape from (this is analogous to “quenching” in the
thermodynamic metaphor). The value of rt must be between 0 and 1.</p>
</div>
<div id="nt" class="section level4 hasAnchor" number="11.2.3.5">
<h4><span class="header-section-number">11.2.3.5</span> nt<a href="chap-optim.html#nt" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the number of loops that the algorithm will perform before
reducing the temperature parameter. Higher values here will mean that
the algorithm will explore the current search area more thoroughly,
improving the chance of finding a global minimum, at the cost of
considerably higher computational time. Conversely, lower values will
mean that the current search area is not explored as thoroughly, with a
corresponding reduction in computation time. Note that each temperature
loop consists of all of the “ns” step loops.</p>
</div>
<div id="ns" class="section level4 hasAnchor" number="11.2.3.6">
<h4><span class="header-section-number">11.2.3.6</span> ns<a href="chap-optim.html#ns" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the number of loops that the algorithm will perform before
adjusting the maximum step length parameter. The maximum step length is
periodically adjusted so that approximately half of all moves are
accepted, since too many, or too few, accepted moves is a waste of
computational effort.</p>
<p>When the algorithm adjusts the maximum step length, the ratio of
accepted moves to rejected moves since the last adjustment of the
maximum step length is taken into account. If more moves are accepted
than rejected, the maximum step length will fall and so the search will
focus on the most promising area. However, if more moves are rejected
that accepted, the maximum step length will rise so the search area will
widen.</p>
</div>
<div id="vm" class="section level4 hasAnchor" number="11.2.3.7">
<h4><span class="header-section-number">11.2.3.7</span> vm<a href="chap-optim.html#vm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the initial maximum step length for the Simulated Annealing
algorithm. The maximum step length will get adjusted during the
optimisation process. Note that each of the steps taken by the Simulated
Annealing algorithm are not uniform, and will have a random length of
between zero and the maximum step length.</p>
<p>It is important to note that unlike the Hooke &amp; Jeeves algorithm, the
parameters are not scaled during the optimisation process, and so the
maximum step length should be selected so that the initial search area
will cover the area of interest. For efficient use of the Simulated
Annealing algorithm, it is recommended that the parameters to be
estimated are scaled (by the user) so that they are all approximately
the same order of magnitude.</p>
</div>
<div id="cstep-lratio-and-uratio" class="section level4 hasAnchor" number="11.2.3.8">
<h4><span class="header-section-number">11.2.3.8</span> cstep, lratio and uratio<a href="chap-optim.html#cstep-lratio-and-uratio" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>These parameters control how the maximum step length for the Simulated
Annealing algorithm is adjusted, at the end of each of the “ns” step
loops. The algorithm keeps track of the number of moves that are
accepted and rejected for each direction, and then adjusts the value of
the maximum step length for each direction so that the ratio of accepted
to rejected moves is approximately 50:50. The maximum step length for
each direction is adjusted according to
equation <a href="chap-optim.html#eq:vm">(11.2)</a>
below:</p>
<p><span class="math display" id="eq:vm">\[\begin{equation}
\tag{11.2}
vm_{i} =
\begin{cases}
vm_{i} * (1 + \frac{C (R_{i} - U)}{L}) &amp; \textrm{if $R_{i} &gt; U$} \\
vm_{i} / (1 + \frac{C (L - R_{i})}{L}) &amp; \textrm{if $R_{i} &lt; L$} \\
vm_{i} &amp; \textrm{otherwise}
\end{cases}\end{equation}\]</span></p>
<p>where: <span class="math inline">\(&lt; R_{i} &gt;\)</span> is the ratio of accepted moves for direction i <span class="math inline">\(&lt;\)</span> C
<span class="math inline">\(&gt;\)</span> is the value of the “cstep” parameter <span class="math inline">\(&lt;\)</span> U <span class="math inline">\(&gt;\)</span> is the value of the
“uratio” parameter <span class="math inline">\(&lt;\)</span> L <span class="math inline">\(&gt;\)</span> is the value of the “lratio” parameter</p>
</div>
<div id="check" class="section level4 hasAnchor" number="11.2.3.9">
<h4><span class="header-section-number">11.2.3.9</span> check<a href="chap-optim.html#check" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the number of temperature loops that the Simulated Annealing
algorithm will check to confirm that the current best point that has
been found is a stable minimum, so that it can be accepted as a
solution.</p>
</div>
</div>
</div>
<div id="sec-bfgs" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> BFGS<a href="chap-optim.html#sec-bfgs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="subsec-bfgsover" class="section level3 hasAnchor" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> Overview<a href="chap-optim.html#subsec-bfgsover" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>BFGS is a quasi-Newton optimisation method that uses information about
the gradient of the function at the current point to calculate the best
direction to look in to find a better point. Using this information, the
BFGS algorithm can iteratively calculate a better approximation to the
inverse Hessian matrix, which will lead to a better approximation of the
minimum value.</p>
<p>From an initial starting point, the gradient of the function is
calculated and then the algorithm uses this information to calculate the
best direction to perform a linesearch for a point that is “sufficiently
better”. The linesearch that is used in Gadget to look for a better
point in this direction is the “Armijo” linesearch. The algorithm will
then adjust the current estimate of the inverse Hessian matrix, and
restart from this new point. If a better point cannot be found, then the
inverse Hessian matrix is reset and the algorithm restarts from the last
accepted point.</p>
<p>For a point at a stable minimum, the magnitude of the gradient vector
will be zero, since there is no direction that the algorithm can move in
to find a better local point. However, finding such a point using an
iterative process can take an infinite number of steps, so the algorithm
exits when the magnitude of the gradient vector is less than a small
number. The current point is then accepted as being the ‘solution’.</p>
<p>The “Armijo” linesearch calculates the stepsize that is to be used to
move to a point that is “sufficiently better”, along the search
direction vector calculated from the gradient, to be <span class="math inline">\(\beta^n\)</span>, where n
is the first integer that satisfies the Armijo rule given by
inequality<a href="chap-optim.html#eq:armijo">(11.3)</a> below:</p>
<p><span class="math display" id="eq:armijo">\[\begin{equation}
\tag{11.3}
f(x) - f(x + \beta^{n}d) \geq - \sigma \beta^{n}d \nabla f(x) ^{T}\end{equation}\]</span></p>
<p>where: <span class="math inline">\(&lt;\nabla f(x)&gt;\)</span> is the gradient of the function at the current
point <span class="math inline">\(&lt;\)</span> d <span class="math inline">\(&gt;\)</span> is the search direction vector</p>
<p>In comparison to the other optimising algorithms that are currently
implemented in Gadget, BFGS performs a local search, and so it doesn’t
cover the wide search area that the Simulated Annealing algorithm can
use to look for an optimum. BFGS will usually take more computer time to
find an optimum than the Hooke &amp; Jeeves algorithm, since numerically
calculating the gradient of the function is computationally very
intensive. However, the optimum found by the BFGS algorithm will usually
be better than that found by the Hooke &amp; Jeeves algorithm, since a
gradient search method is usually more accurate than a stepwise search
method.</p>
<p>The BFGS algorithm used in Gadget is derived from that presented by
Dimitri P Bertsekas, “Nonlinear Programming” (<span class="math inline">\(2^{nd}\)</span> edition, pp22-61)
published by Athena Scientific. The forward difference gradient
algorithm used to calculate the gradient is derived from that presented
by Dennis and Schnabel, “Numerical Methods for Unconstrained
Optimisation and Nonlinear Equations” (“Classics” edition, published by
SIAM).</p>
</div>
<div id="subsec-bfgsfile" class="section level3 hasAnchor" number="11.3.2">
<h3><span class="header-section-number">11.3.2</span> File Format<a href="chap-optim.html#subsec-bfgsfile" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To specify the BFGS algorithm, the optimisation file should start with
the keyword “<a href="chap-optim.html#sec-bfgs">bfgs</a>”, followed by (up to) 7 lines giving the
parameters for the optimisation algorithm. Any parameters that are not
specified in the file are given default values, which work reasonably
well for simple Gadget models. The format for this file, and the default
values for the optimisation parameters, are shown below:</p>
<pre><code>[bfgs]
bfgsiter   10000 ; number of bfgs iterations
bfgseps    0.01  ; minimum epsilon, bfgs halt criteria
sigma      0.01  ; armijo convergence criteria
beta       0.3   ; armijo adjustment factor
gradacc    1e-06 ; initial value for gradient accuracy
gradstep   0.5   ; gradient accuracy adjustment factor
gradeps    1e-10 ; minimum value for gradient accuracy</code></pre>
</div>
<div id="subsec-bfgspar" class="section level3 hasAnchor" number="11.3.3">
<h3><span class="header-section-number">11.3.3</span> Parameters<a href="chap-optim.html#subsec-bfgspar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="bfgsiter" class="section level4 hasAnchor" number="11.3.3.1">
<h4><span class="header-section-number">11.3.3.1</span> bfgsiter<a href="chap-optim.html#bfgsiter" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the maximum number of Gadget model runs that the BFGS algorithm
will use to try to find the best solution. If this number is exceeded,
Gadget will select the best point found so far, and accept this as the
‘solution’, even though it has not met the convergence criteria. A
warning that Gadget has stopped without finding a solution that meets
the convergence criteria will be printed.</p>
</div>
<div id="bfgseps" class="section level4 hasAnchor" number="11.3.3.2">
<h4><span class="header-section-number">11.3.3.2</span> bfgseps<a href="chap-optim.html#bfgseps" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the criteria for halting the BFGS algorithm at a minimum, and
accepting the current point as the ‘solution’. The algorithm has
“converged” if the magnitude of the gradient vector is less than
bfgseps. Lower values of bfgseps will give a better estimate of the
minimum, at the cost of a considerably increased running time. At the
true minimum, the magnitude of the gradient vector will be zero, since
there would be no direction for the algorithm to move to, but this point
could take an infinite number of iterations to find.</p>
</div>
<div id="sigma" class="section level4 hasAnchor" number="11.3.3.3">
<h4><span class="header-section-number">11.3.3.3</span> sigma<a href="chap-optim.html#sigma" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the criteria for stopping the Armijo linesearch at a point that
is “sufficiently better”, and recalculating the gradient of the function
at this new point. Lower values of sigma will increase the size of the
acceptance region of the Armijo linesearch (by relaxing the condition
for the inequality, see
equation <a href="chap-optim.html#eq:armijo">(11.3)</a> above), which will mean that the linesearch will
stop earlier, leading to larger steps by the BFGS algorithm. Conversely,
higher values of sigma will decrease the size of the acceptance region,
which will mean that the BFGS algorithm will take smaller steps. The
value of sigma must be between 0 and 1, and should be close to zero.</p>
</div>
<div id="beta" class="section level4 hasAnchor" number="11.3.3.4">
<h4><span class="header-section-number">11.3.3.4</span> beta<a href="chap-optim.html#beta" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is the adjustment factor for the Armijo linesearch, used to
calculate the size of the step taken by the linesearch to find the next
point. Lower values of beta will mean that the size of the step that the
algorithm tries to take in the direction of the gradient vector is
smaller, but the step is more likely to be in the acceptance region.
Conversely, higher values of beta will result in larger steps being
tried, but these steps are more likely to be rejected since they may be
outside the acceptance region. The value of beta must be between 0 and
1.</p>
</div>
<div id="gradacc-gradstep-and-gradeps" class="section level4 hasAnchor" number="11.3.3.5">
<h4><span class="header-section-number">11.3.3.5</span> gradacc, gradstep and gradeps<a href="chap-optim.html#gradacc-gradstep-and-gradeps" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>These parameters control the accuracy that is used for the gradient
calculations. The gradient of the function is calculated numerically by
Gadget using a forward difference algorithm, as shown in
equation <a href="chap-optim.html#eq:grad">(11.4)</a> below:</p>
<p><span class="math display" id="eq:grad">\[\begin{equation}
\tag{11.4}
\nabla f(x) \approx \frac{f(x + \delta x) - f(x)} {\delta x}\end{equation}\]</span></p>
<p>where: <span class="math inline">\(&lt;\delta&gt;\)</span> is the value of the “gradacc” parameter</p>
<p>When the BFGS algorithm is reset (that is, if the Armijo linesearch
fails to find a better point) the gradient accuracy parameter is made
smaller to increase the level of accuracy that is used in the gradient
calculations. This is done by multiplying the gradacc parameter by the
gradstep parameter, which is a simple reduction factor (and as such must
be between 0 and 1). To prevent the gradacc parameter getting too small,
the BFGS algorithm will stop once the value of gradacc is less that the
value of gradeps. Both gradacc and gradeps must be between 0 and 1, with
gradeps smaller than gradacc, and the gradient calculations are more
accurate when the gradacc parameter is very small.</p>
</div>
</div>
</div>
<div id="sec-combine" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Combining Optimisation Algorithms<a href="chap-optim.html#sec-combine" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="subsec-combineover" class="section level3 hasAnchor" number="11.4.1">
<h3><span class="header-section-number">11.4.1</span> Overview<a href="chap-optim.html#subsec-combineover" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This method attempts to combine the global search of the Simulated
Annealing algorithm and the more rapid convergence of the local searches
performed by the Hooke &amp; Jeeves and BFGS algorithms. It relies on the
observation that the likelihood function for many Gadget models consists
of a large ‘valley’ in which the best solution lies, surrounded by much
more ‘rugged’ terrain.</p>
<p>A period of Simulated Annealing at the start of the optimisation run
serves to move the search into this valley, at which point the Simulated
Annealing algorithm becomes inefficient so the Hooke &amp; Jeeves algorithm
and/or the BFGS algorithm takes over and homes in on a solution within
that valley. Hopefully the Simulated Annealing algorithm will have moved
the current point to the correct side of any ‘hills’ to avoid the local
searches becoming trapped into an unrealistic local minimum.</p>
</div>
<div id="subsec-combinefile" class="section level3 hasAnchor" number="11.4.2">
<h3><span class="header-section-number">11.4.2</span> File Format<a href="chap-optim.html#subsec-combinefile" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To specify a combination of optimisation algorithms, the optimisation
file should simply list the algorithms that should be used, along with
the parameters for each optimisation algorithm. Any parameters that are
not specified in the file are given default values, which work
reasonably well for simple Gadget models. As an example, the format for
this file used to specify all three optimisation algorithms, and the
default values for the optimisation parameters, is shown below:</p>
<pre><code>[simann]
simanniter 2000  ; number of simulated annealing iterations
simanneps  1e-04 ; minimum epsilon, simann halt criteria
t          100   ; simulated annealing initial temperature
rt         0.85  ; temperature reduction factor
nt         2     ; number of loops before temperature adjusted
ns         5     ; number of loops before step length adjusted
vm         1     ; initial value for the maximum step length
cstep      2     ; step length adjustment factor
lratio     0.3   ; lower limit for ratio when adjusting step length
uratio     0.7   ; upper limit for ratio when adjusting step length
check      4     ; number of temperature loops to check
[hooke]
hookeiter  1000  ; number of hooke &amp; jeeves iterations
hookeeps   1e-04 ; minimum epsilon, hooke &amp; jeeves halt criteria
rho        0.5   ; step length adjustment factor
lambda     0     ; initial value for the step length
[bfgs]
bfgsiter   10000 ; number of bfgs iterations
bfgseps    0.01  ; minimum epsilon, bfgs halt criteria
sigma      0.01  ; armijo convergence criteria
beta       0.3   ; armijo adjustment factor
gradacc    1e-06 ; initial value for gradient accuracy
gradstep   0.5   ; gradient accuracy adjustment factor
gradeps    1e-10 ; minimum value for gradient accuracy</code></pre>
<p>It should be noted that the optimisation algorithms will be performed in
the order that they are specified in the input file, so for this example
the order will be: first Simulated Annealing, second Hooke &amp; Jeeves and
finally BFGS.</p>
</div>
<div id="subsec-combinepar" class="section level3 hasAnchor" number="11.4.3">
<h3><span class="header-section-number">11.4.3</span> Parameters<a href="chap-optim.html#subsec-combinepar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The parameters for this combined optimisation algorithm are the same as
for the individual algorithms, and are described in sections
<a href="#subsec:hookepar" reference-type="ref" reference="subsec:hookepar">11.1.3</a> (for the Hooke &amp; Jeeves parameters),
<a href="#subsec:simannpar" reference-type="ref" reference="subsec:simannpar">11.2.3</a> (for the Simulated Annealing parameters)
and <a href="#subsec:bfgspar" reference-type="ref" reference="subsec:bfgspar">11.3.3</a> (for the BFGS parameters).</p>
</div>
</div>
<div id="sec-repeat" class="section level2 hasAnchor" number="11.5">
<h2><span class="header-section-number">11.5</span> Repeatability<a href="chap-optim.html#sec-repeat" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The optimisation algorithms used by Gadget contain a random number
generator, used to randomise the order of the parameters (to ensure that
the order of the parameters has no effect on the optimum found) and to
generate the initial direction chosen by the algorithm to look for a
solution. For the Simulated Annealing algorithm, this is also affects
the Metropolis criteria used to accept any changes in an ‘uphill’
direction.</p>
<p>The use of a random number generator means that it is unlikely that two
optimising runs will produce exactly the same ‘optimum’, even if they
start from the same point (although it is hoped that the optima would be
very similar if a stable starting point was chosen). This causes a
problem with repeatability, since there is no guarantee that an
optimising run can be repeated. However, it is possible to ‘seed’ the
random number generator with an integer to avoid this problem. To
specify a seed for the random number generator, an extra line must be
added to the optimisation file, as shown below:</p>
<pre><code>seed       n     ; seed the random number generator with n</code></pre>
<p>It is also possible to specify the value that is used to seed the random
number generator from the command line, by starting Gadget with the
“-seed &lt;number&gt;” switch. It should be noted that any value for the
seed that is specified in the optimisation file will override the value
that is specified as a command line option.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chap-param.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chap-output.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
